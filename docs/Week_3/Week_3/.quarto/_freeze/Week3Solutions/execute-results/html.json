{
  "hash": "7aaec6f30c08330f1a4ce507e63477cb",
  "result": {
    "markdown": "---\ntitle: \"Week 3 Tasks Solutions\"\nformat: \n  html: default\n  pdf:  default\neditor: visual\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(moderndive)\nlibrary(gapminder)\nlibrary(skimr)\nlibrary(mvtnorm)\nlibrary(gridExtra)\nlibrary(ISLR)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n# Tasks\n\n1.  Examine the relationship between teaching score and age in the `evals` data set. What is the value of the correlation coefficient? How would you interpret this verbally? Finally, produce a scatterplot of teaching score and age.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevals.age <- evals |>\n  select(score, age)\nevals.age |>\n  get_correlation(formula = score ~ age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n     cor\n   <dbl>\n1 -0.107\n```\n:::\n\n```{.r .cell-code}\nggplot(evals.age, aes(x = age, y = score)) +\n  geom_point() +\n  labs(x = \"Age\", y = \"Teaching Score\",\n       title = \"Relationship between Teaching Score and Age\")\n```\n\n::: {.cell-output-display}\n![](Week3Solutions_files/figure-html/task2-solution-1.png){width=672}\n:::\n:::\n\n\n\\newpage\n\n2.  Perform a formal analysis of the relationship between teaching score and age by fitting a simple linear regression model. Superimpose your best-fitting line onto your scatterplot from Task 1.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevals.age <- evals |>\n  select(score, age)\nmodel <- linear_reg() |> fit(score ~ age, data = evals.age)\nmodel$fit\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nstats::lm(formula = score ~ age, data = data)\n\nCoefficients:\n(Intercept)          age  \n   4.461932    -0.005938  \n```\n:::\n\n```{.r .cell-code}\nggplot(evals.age, aes(x = age, y = score)) +\n  geom_point() +\n  labs(x = \"Age\", y = \"Teaching Score\",\n       title = \"Relationship between Teaching Score and Age\") +\n  geom_smooth(method = \"lm\", se = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Week3Solutions_files/figure-html/task3-solution-1.png){width=672}\n:::\n:::\n\n\n\\newpage\n\n3.  Assess the model assumptions from Task 2 by plotting the residuals against the explanatory variable and fitted values, respectively. Also, plot a histogram of the residuals to assess whether they are normally distributed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevals.age <- evals |>\n  select(score, age)\nmodel <- linear_reg() |> fit(score ~ age, data = evals.age)\nregression.points <- get_regression_points(model$fit)\nggplot(regression.points, aes(x = age, y = residual)) +\n  geom_point() +\n  labs(x = \"Age\", y = \"Residual\") +\n  geom_hline(yintercept = 0, col = \"blue\", size = 1)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](Week3Solutions_files/figure-html/task4-solution-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(regression.points, aes(x = score_hat, y = residual)) +\n  geom_point() +\n  labs(x = \"Fitted values\", y = \"Residual\") +\n  geom_hline(yintercept = 0, col = \"blue\", size = 1)\n```\n\n::: {.cell-output-display}\n![](Week3Solutions_files/figure-html/task4-solution-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(regression.points, aes(x = residual)) +\n  geom_histogram(binwidth = 0.25, color = \"white\") +\n  labs(x = \"Residual\")\n```\n\n::: {.cell-output-display}\n![](Week3Solutions_files/figure-html/task4-solution-3.png){width=672}\n:::\n:::\n\n\n\\newpage\n\n4.  Perform the same analysis we did on life expectancy from the `gapminder` data set in 2007. However, subset the data for the year 1997. Are there any differences in the results across this 10 year period?\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    gapminder1997 <- gapminder |>\n      filter(year == 1997) |>\n      select(country, continent, lifeExp)\n    \n    lifeExp.continent <- gapminder1997 |>\n      summarize(median = median(lifeExp), mean = mean(lifeExp),.by=continent)\n    lifeExp.continent\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    # A tibble: 5 × 3\n      continent median  mean\n      <fct>      <dbl> <dbl>\n    1 Asia        70.3  68.0\n    2 Europe      76.1  75.5\n    3 Africa      52.8  53.6\n    4 Americas    72.1  71.2\n    5 Oceania     78.2  78.2\n    ```\n    :::\n    \n    ```{.r .cell-code}\n    lifeExp.model <- linear_reg() |> fit(lifeExp ~ continent, data = gapminder1997)\n    lifeExp.model\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    parsnip model object\n    \n    \n    Call:\n    stats::lm(formula = lifeExp ~ continent, data = data)\n    \n    Coefficients:\n          (Intercept)  continentAmericas      continentAsia    continentEurope  \n                53.60              17.55              14.42              21.91  \n     continentOceania  \n                24.59  \n    ```\n    :::\n    :::\n\n\n    \\newpage\n\n5.  Return to the `Credit` data set and fit a multiple regression model with `Balance` as the outcome variable, and `Income` and `Age` as the explanatory variables, respectively. Assess the assumptions of the multiple regression model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCred <- Credit |>\n  select(Balance, Income, Age)\n\nCred |>\n  skim()\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |     |\n|:------------------------|:----|\n|Name                     |Cred |\n|Number of rows           |400  |\n|Number of columns        |3    |\n|_______________________  |     |\n|Column type frequency:   |     |\n|numeric                  |3    |\n|________________________ |     |\n|Group variables          |None |\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|   mean|     sd|    p0|   p25|    p50|    p75|    p100|hist  |\n|:-------------|---------:|-------------:|------:|------:|-----:|-----:|------:|------:|-------:|:-----|\n|Balance       |         0|             1| 520.02| 459.76|  0.00| 68.75| 459.50| 863.00| 1999.00|▇▅▃▂▁ |\n|Income        |         0|             1|  45.22|  35.24| 10.35| 21.01|  33.12|  57.47|  186.63|▇▂▁▁▁ |\n|Age           |         0|             1|  55.67|  17.25| 23.00| 41.75|  56.00|  70.00|   98.00|▆▇▇▇▁ |\n:::\n\n```{.r .cell-code}\nCred |>\n  cor()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Balance    Income         Age\nBalance 1.000000000 0.4636565 0.001835119\nIncome  0.463656457 1.0000000 0.175338403\nAge     0.001835119 0.1753384 1.000000000\n```\n:::\n\n```{.r .cell-code}\nggplot(Cred, aes(x = Age, y = Balance)) +\n  geom_point() +\n  labs(x = \"Age (in years)\", y = \"Credit card balance (in $)\",\n       title = \"Relationship between balance and age\") +\n  geom_smooth(method = \"lm\", se = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Week3Solutions_files/figure-html/task2-1.png){width=60%}\n:::\n\n```{.r .cell-code}\nBalance.model <- linear_reg() |> fit(Balance ~ Age + Income, data = Cred)\ntidy(Balance.model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)   360.      70.4        5.11 4.97e- 7\n2 Age            -2.19     1.20      -1.82 6.91e- 2\n3 Income          6.24     0.587     10.6  2.20e-23\n```\n:::\n\n```{.r .cell-code}\nregression.points <- get_regression_points(Balance.model$fit)\n\nggplot(regression.points, aes(x = Income, y = residual)) +\n  geom_point() +\n  labs(x = \"Income (in $1000)\", y = \"Residual\", title = \"Residuals vs income\")  +\n  geom_hline(yintercept = 0, col = \"blue\", size = 1)\n```\n\n::: {.cell-output-display}\n![](Week3Solutions_files/figure-html/task2-2.png){width=60%}\n:::\n\n```{.r .cell-code}\nggplot(regression.points, aes(x = Age, y = residual)) +\n  geom_point() +\n  labs(x = \"Age (in years)\", y = \"Residual\", title = \"Residuals vs age\")  +\n  geom_hline(yintercept = 0, col = \"blue\", size = 1)\n```\n\n::: {.cell-output-display}\n![](Week3Solutions_files/figure-html/task2-3.png){width=60%}\n:::\n\n```{.r .cell-code}\nggplot(regression.points, aes(x = residual)) +\n  geom_histogram(color = \"white\") +\n  labs(x = \"Residual\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](Week3Solutions_files/figure-html/task2-4.png){width=60%}\n:::\n:::\n",
    "supporting": [
      "Week3Solutions_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}