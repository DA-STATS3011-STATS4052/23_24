{
  "hash": "f62e0e3d35f878adafd3c4683ec9f0d2",
  "result": {
    "markdown": "---\ntitle: |\n  | Data Analysis\n  | Week 9 Further Tasks Solutions\noutput:\n  pdf_document:\n    fig_caption: yes\n    latex_engine: xelatex\n    number_sections: no\n  html_document:\n    df_print: paged\nheader-includes: \\usepackage{float}\n---\n\n\n\n```{=html}\n<style>\np.caption {\n  font-size: 1.4em;\n}\n</style>\n```\n\n\n# Further Tasks\n\n## Yanny or Laurel?\n\nThis auditory illusion first appeared on the internet in May 2018. An explanation of why people hear different things can be found in this [short video](https://www.youtube.com/watch?v=yDiXQl7grPQ), just one of many internet sources discussing the phenomenon. The main reason behind the difference appears to be that as we age we lose the ability to hear certain sounds. To see if we could find evidence of such an age effect, we asked students and staff at the School of Mathematics and Statistics at the University of Glasgow to fill out a survey on what they hear. Below you can see summaries of the responses.\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/07_yl1.png){fig-align='center' fig-pos='H' width=65%}\n:::\n\n::: {.cell-output-display}\n![](images/07_yl2.png){fig-align='center' fig-pos='H' width=65%}\n:::\n\n::: {.cell-output-display}\n![](images/07_yl3.png){fig-align='center' fig-pos='H' width=65%}\n:::\n:::\n\n\n\nThe proportions hearing `Yanny` and `Laurel` are very similar to each other, and there are some respondents who hear both or even something completely different. This may be because people do not listen to the audio file using the same device, something we couldn't control for in the survey. Ignoring the responses other than `Yanny` or `Laurel`, we have 53 observations.\n\nDownload the data (`yanny.csv`) from Moodle and fit a logistic regression model with `hear` as the binary response variable, and `age` and `gender` as the explanatory variables. What are your findings?\n\n**Solution**\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nyanny <- read_csv(\"yanny.csv\")\nyanny <- yanny %>%\n          select(hear, gender, age)\nyanny$hear <- as.factor(yanny$hear)\nyanny$gender <- as.factor(yanny$gender)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = yanny, aes(x = hear, y = age, fill = hear)) +\n  geom_boxplot() +\n  labs(x = \"What do you hear?\", y = \"Age\") +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![Hearing Yanny/Laurel by age.](DA_Week9_FurtherTasksSolutions_files/figure-pdf/unnamed-chunk-3-1.pdf){fig-align='center' fig-pos='H' width=65%}\n:::\n:::\n\n\n\nWe see in the boxplot that the people who hear `Yanny` are, on average, younger, however there is some overlap in the IQR's.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nyanny %>%\n  tabyl(gender, hear) %>%\n  adorn_percentages() %>%\n  adorn_pct_formatting() %>%\n  adorn_ns() # To show original counts\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n gender     Laurel      Yanny\n Female 50.0% (14) 50.0% (14)\n   Male 56.0% (14) 44.0% (11)\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = yanny, aes(x = hear, group = gender)) +\n  geom_bar(aes(y = ..prop.., fill = gender), stat = \"count\", position = \"dodge\") +\n  labs(x = \"What do you hear?\", y = \"Proportion\")\n```\n\n::: {.cell-output-display}\n![Barplot of what participants heard by gender.](DA_Week9_FurtherTasksSolutions_files/figure-pdf/unnamed-chunk-5-1.pdf){fig-align='center' fig-pos='H' width=65%}\n:::\n:::\n\n\n\nThere is a slightly smaller proportion of men hearing `Yanny`, but the proportions are very similar overall.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmod.yanny <- glm(hear ~ age + gender, data = yanny, family = binomial(link = \"logit\"))\n\nmod.yanny %>%\n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = hear ~ age + gender, family = binomial(link = \"logit\"), \n    data = yanny)\n\nDeviance Residuals: \n   Min      1Q  Median      3Q     Max  \n-1.381  -1.099  -0.776   1.154   1.809  \n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)\n(Intercept)  1.62792    1.24392   1.309    0.191\nage         -0.04839    0.03404  -1.422    0.155\ngenderMale  -0.20637    0.56935  -0.362    0.717\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 71.779  on 51  degrees of freedom\nResidual deviance: 69.454  on 49  degrees of freedom\n  (1 observation deleted due to missingness)\nAIC: 75.454\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmod.yanny <- glm(hear ~ age, data = yanny, family = binomial(link = \"logit\"))\n\nmod.yanny %>%\n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = hear ~ age, family = binomial(link = \"logit\"), \n    data = yanny)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.3566  -1.0881  -0.7971   1.1457   1.8505  \n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)\n(Intercept)  1.51874    1.21032   1.255     0.21\nage         -0.04812    0.03423  -1.406     0.16\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 71.779  on 51  degrees of freedom\nResidual deviance: 69.586  on 50  degrees of freedom\n  (1 observation deleted due to missingness)\nAIC: 73.586\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n:::\n\n\n\nNotice that the coefficient of `age` is negative, suggesting that older people are less likely to hear `Yanny`. However, the coefficient of `age` is not significant ($p$-value of 0.16). Still, if we wanted to use the estimated coefficient to quantify the effect of `age`, we would need to look at exp(-0.04812) = 0.953. This suggests that for two people who differ by one year in age, the older person's odds of hearing `Yanny` are 0.953 times those of the younger person. If we want to look at a ten-year age difference then the odds multiplier becomes exp(0.04812 \\* 10) = 1.618. Hence, for two people who differ by 10 years in age, the older person's odds of hearing `Yanny` are 1.618 times those of the younger person.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_model(mod.yanny, show.values = TRUE,\n           title = \"Odds (Age)\", show.p = TRUE)\n```\n\n::: {.cell-output-display}\n![Odds of hearing yanny with age.](DA_Week9_FurtherTasksSolutions_files/figure-pdf/unnamed-chunk-8-1.pdf){fig-align='center' fig-pos='H' width=55%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_model(mod.yanny, type = \"pred\", terms = \"age\", title = \"\", axis.title = c(\"Age\", \"Probability of hearing Yanny\"))\n```\n\n::: {.cell-output-display}\n![Probability of hearing Yanny with age.](DA_Week9_FurtherTasksSolutions_files/figure-pdf/unnamed-chunk-9-1.pdf){fig-align='center' fig-pos='H' width=65%}\n:::\n:::\n\n\n\n## Titanic\n\nOn 15th April 1912, during its maiden voyage, the [Titanic](https://en.wikipedia.org/wiki/RMS_Titanic) sank after colliding with an iceberg, killing 1502 out of 2224 passengers and crew. One of the reasons that the shipwreck led to such loss of life was that there were not enough lifeboats for the passengers and crew. Although there was some element of luck involved in surviving the sinking, some groups of people were more likely to survive than others, such as women, children, and the upper-class.\n\nDownload the data (`titanic.csv`) from Moodle for $n = 891$ passengers aboard the Titanic and fit a logistic regression model with `survived` as the binary response variable, and `age`, `gender`, and `passenger.class` as the explanatory variables. What are your findings?\n\n**Solution**\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntitanic <- read_csv(\"titanic.csv\")\ntitanic <- titanic %>%\n          select(survived, age, gender, passenger.class)\ntitanic$survived <- as.factor(titanic$survived)\nlevels(titanic$survived) <- c(\"Died\", \"Survived\")\ntitanic$gender <- as.factor(titanic$gender)\ntitanic$passenger.class <- as.factor(titanic$passenger.class)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = titanic, aes(x = survived, y = age, fill = survived)) +\n  geom_boxplot() +\n  labs(x = \"Survived the Titanic?\", y = \"Age\") +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![Titanic passenger age by survival.](DA_Week9_FurtherTasksSolutions_files/figure-pdf/unnamed-chunk-11-1.pdf){fig-align='center' fig-pos='H' width=50%}\n:::\n:::\n\n\n\nWe see in the boxplot that there is very little difference in the age of passengers who died or survived the sinking of the Titanic.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntitanic %>%\n  tabyl(gender, survived) %>%\n  adorn_percentages() %>%\n  adorn_pct_formatting() %>%\n  adorn_ns() # To show original counts\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n gender        Died    Survived\n female 25.8%  (81) 74.2% (233)\n   male 81.1% (468) 18.9% (109)\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = titanic, aes(x = survived, group = gender)) +\n  geom_bar(aes(y = ..prop.., fill = gender), stat = \"count\", position = \"dodge\") +\n  labs(x = \"Survived the Titanic?\", y = \"Proportion\")\n```\n\n::: {.cell-output-display}\n![Barplot of passenger survival by gender.](DA_Week9_FurtherTasksSolutions_files/figure-pdf/unnamed-chunk-13-1.pdf){fig-align='center' fig-pos='H' width=50%}\n:::\n:::\n\n\n\nThere is a clear pattern here with the proportion surviving much higher for females than for males.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntitanic %>%\n  tabyl(passenger.class, survived) %>%\n  adorn_percentages() %>%\n  adorn_pct_formatting() %>%\n  adorn_ns() # To show original counts\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n passenger.class        Died    Survived\n               1 37.0%  (80) 63.0% (136)\n               2 52.7%  (97) 47.3%  (87)\n               3 75.8% (372) 24.2% (119)\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = titanic, aes(x = survived, group = passenger.class)) +\n  geom_bar(aes(y = ..prop.., fill = passenger.class),\n            stat = \"count\", position = \"dodge\") +\n  labs(x = \"Survived the Titanic?\", y = \"Proportion\")\n```\n\n::: {.cell-output-display}\n![Barplot of passenger survival by gender.](DA_Week9_FurtherTasksSolutions_files/figure-pdf/unnamed-chunk-15-1.pdf){fig-align='center' fig-pos='H' width=50%}\n:::\n:::\n\n\n\nThe largest group of passengers who died were third class passengers, while among those who survived the largest group was first class passengers.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmod.titanic <- glm(survived ~ gender + passenger.class + age, data = titanic,\n                    family = binomial(link = \"logit\"))\nmod.titanic %>%\n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = survived ~ gender + passenger.class + age, family = binomial(link = \"logit\"), \n    data = titanic)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.6490  -0.6636  -0.4198   0.6328   2.4283  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(>|z|)    \n(Intercept)       3.54474    0.36537   9.702  < 2e-16 ***\ngendermale       -2.61131    0.18671 -13.986  < 2e-16 ***\npassenger.class2 -1.12216    0.25773  -4.354 1.34e-05 ***\npassenger.class3 -2.32917    0.24089  -9.669  < 2e-16 ***\nage              -0.03330    0.00737  -4.519 6.21e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1186.66  on 890  degrees of freedom\nResidual deviance:  805.29  on 886  degrees of freedom\nAIC: 815.29\n\nNumber of Fisher Scoring iterations: 5\n```\n:::\n:::\n\n\n\nWe see that the coefficient for males (`gendermale`) is negative, indicating a lower chance of survival for male passengers. Similarly, the coefficients for second (`passenger.class2`) and third (`passenger.class3`) class passengers are negative, with the magnitude of the third class coefficient larger than that of the second class coefficient. This suggests that second class passengers chances of survival were worse in comparison with first class passengers, and that third class passengers chances of survival were even worse. Finally the `age` coefficient is negative, suggesting that older people were less likely to survive.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_model(mod.titanic, show.values = TRUE,\n           title = \"\", show.p = FALSE, value.offset = 0.25)\n```\n\n::: {.cell-output-display}\n![Odds of surviving the sinking of the Titanic.](DA_Week9_FurtherTasksSolutions_files/figure-pdf/unnamed-chunk-17-1.pdf){fig-align='center' fig-pos='H' width=55%}\n:::\n:::\n\n\n\nWe interpret the odds ratios as follows: men's odds of survival were 0.07 times those of women, third class passengers' odds of survival were 0.10 times those of first class passengers, and second class passengers' odds of survival were 0.33 times those of first class passengers. Finally, for each year increase in the passenger's age, their odds of survival decrease (by a factor of 0.97).\n",
    "supporting": [
      "DA_Week9_FurtherTasksSolutions_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}