{"title":"| Data Analysis\n| Week 9 Further Tasks Solutions","markdown":{"yaml":{"title":"| Data Analysis\n| Week 9 Further Tasks Solutions\n","output":{"pdf_document":{"fig_caption":"yes","latex_engine":"xelatex","number_sections":"no"},"html_document":{"df_print":"paged"}},"header-includes":"\\usepackage{float}"},"headingText":"Further Tasks","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(moderndive)\nlibrary(ISLR)\nlibrary(skimr)\nlibrary(plotly)\nlibrary(tidyr)\nlibrary(datasets)\nlibrary(knitr)\nlibrary(janitor)\nlibrary(infer)\nlibrary(sjPlot)\nlibrary(stats)\nlibrary(readr)\nlibrary(janitor)\nlibrary(tidymodels)\n\nknitr::opts_chunk$set(echo = TRUE, comment = NA, out.width = '65%', fig.align = \"center\", fig.pos = 'H',\n                      warning = FALSE, message = FALSE)\n```\n\n```{=html}\n<style>\np.caption {\n  font-size: 1.4em;\n}\n</style>\n```\n\n## Yanny or Laurel?\n\nThis auditory illusion first appeared on the internet in May 2018. An explanation of why people hear different things can be found in this [short video](https://www.youtube.com/watch?v=yDiXQl7grPQ), just one of many internet sources discussing the phenomenon. The main reason behind the difference appears to be that as we age we lose the ability to hear certain sounds. To see if we could find evidence of such an age effect, we asked students and staff at the School of Mathematics and Statistics at the University of Glasgow to fill out a survey on what they hear. Below you can see summaries of the responses.\n\n```{r, echo = FALSE}\nknitr::include_graphics(\"images/07_yl1.png\")\nknitr::include_graphics(\"images/07_yl2.png\")\nknitr::include_graphics(\"images/07_yl3.png\")\n```\n\nThe proportions hearing `Yanny` and `Laurel` are very similar to each other, and there are some respondents who hear both or even something completely different. This may be because people do not listen to the audio file using the same device, something we couldn't control for in the survey. Ignoring the responses other than `Yanny` or `Laurel`, we have 53 observations.\n\nDownload the data (`yanny.csv`) from Moodle and fit a logistic regression model with `hear` as the binary response variable, and `age` and `gender` as the explanatory variables. What are your findings?\n\n**Solution**\n\n```{r}\nyanny <- read_csv(\"yanny.csv\")\nyanny <- yanny %>%\n          select(hear, gender, age)\nyanny$hear <- as.factor(yanny$hear)\nyanny$gender <- as.factor(yanny$gender)\n```\n\n```{r, fig.cap = \"Hearing Yanny/Laurel by age.\", fig.align = \"center\"}\nggplot(data = yanny, aes(x = hear, y = age, fill = hear)) +\n  geom_boxplot() +\n  labs(x = \"What do you hear?\", y = \"Age\") +\n  theme(legend.position = \"none\")\n```\n\nWe see in the boxplot that the people who hear `Yanny` are, on average, younger, however there is some overlap in the IQR's.\n\n```{r}\nyanny %>%\n  tabyl(gender, hear) %>%\n  adorn_percentages() %>%\n  adorn_pct_formatting() %>%\n  adorn_ns() # To show original counts\n```\n\n```{r, fig.cap = \"Barplot of what participants heard by gender.\", fig.align = \"center\"}\nggplot(data = yanny, aes(x = hear, group = gender)) +\n  geom_bar(aes(y = ..prop.., fill = gender), stat = \"count\", position = \"dodge\") +\n  labs(x = \"What do you hear?\", y = \"Proportion\")\n```\n\nThere is a slightly smaller proportion of men hearing `Yanny`, but the proportions are very similar overall.\n\n```{r}\nmod.yanny <- logistic_reg()\nmod.yanny <- mod.yanny |> \n  fit(hear ~ age + gender, data = yanny) |>\n  extract_fit_engine()\n\nmod.yanny %>%\n  summary()\n```\n\n```{r}\nmod.yanny <- logistic_reg()\nmod.yanny <- mod.yanny |> fit(hear ~ age, data = yanny) |>\n  extract_fit_engine()\n\nmod.yanny %>%\n  summary()\n```\n\nNotice that the coefficient of `age` is negative, suggesting that older people are less likely to hear `Yanny`. However, the coefficient of `age` is not significant ($p$-value of 0.16). Still, if we wanted to use the estimated coefficient to quantify the effect of `age`, we would need to look at exp(-0.04812) = 0.953. This suggests that for two people who differ by one year in age, the older person's odds of hearing `Yanny` are 0.953 times those of the younger person. If we want to look at a ten-year age difference then the odds multiplier becomes exp(0.04812 \\* 10) = 1.618. Hence, for two people who differ by 10 years in age, the older person's odds of hearing `Yanny` are 1.618 times those of the younger person.\n\n```{r, fig.cap = \"Odds of hearing yanny with age.\", fig.align=\"center\", out.width =\"55%\"}\nplot_model(mod.yanny, show.values = TRUE,\n           title = \"Odds (Age)\", show.p = TRUE)\n```\n\n```{r, echo = TRUE, eval = TRUE, fig.cap = \"Probability of hearing Yanny with age.\", fig.align = \"center\", results = FALSE}\nplot_model(mod.yanny, type = \"pred\", terms = \"age\", title = \"\", axis.title = c(\"Age\", \"Probability of hearing Yanny\"))\n```\n\n## Titanic\n\nOn 15th April 1912, during its maiden voyage, the [Titanic](https://en.wikipedia.org/wiki/RMS_Titanic) sank after colliding with an iceberg, killing 1502 out of 2224 passengers and crew. One of the reasons that the shipwreck led to such loss of life was that there were not enough lifeboats for the passengers and crew. Although there was some element of luck involved in surviving the sinking, some groups of people were more likely to survive than others, such as women, children, and the upper-class.\n\nDownload the data (`titanic.csv`) from Moodle for $n = 891$ passengers aboard the Titanic and fit a logistic regression model with `survived` as the binary response variable, and `age`, `gender`, and `passenger.class` as the explanatory variables. What are your findings?\n\n**Solution**\n\n```{r}\ntitanic <- read_csv(\"titanic.csv\")\ntitanic <- titanic %>%\n          select(survived, age, gender, passenger.class)\ntitanic$survived <- as.factor(titanic$survived)\nlevels(titanic$survived) <- c(\"Died\", \"Survived\")\ntitanic$gender <- as.factor(titanic$gender)\ntitanic$passenger.class <- as.factor(titanic$passenger.class)\n```\n\n```{r, fig.cap = \"Titanic passenger age by survival.\", fig.align = \"center\", out.width = \"50%\"}\nggplot(data = titanic, aes(x = survived, y = age, fill = survived)) +\n  geom_boxplot() +\n  labs(x = \"Survived the Titanic?\", y = \"Age\") +\n  theme(legend.position = \"none\")\n```\n\nWe see in the boxplot that there is very little difference in the age of passengers who died or survived the sinking of the Titanic.\n\n```{r}\ntitanic %>%\n  tabyl(gender, survived) %>%\n  adorn_percentages() %>%\n  adorn_pct_formatting() %>%\n  adorn_ns() # To show original counts\n```\n\n```{r, fig.cap = \"Barplot of passenger survival by gender.\", fig.align = \"center\", out.width = \"50%\"}\nggplot(data = titanic, aes(x = survived, group = gender)) +\n  geom_bar(aes(y = ..prop.., fill = gender), stat = \"count\", position = \"dodge\") +\n  labs(x = \"Survived the Titanic?\", y = \"Proportion\")\n```\n\nThere is a clear pattern here with the proportion surviving much higher for females than for males.\n\n```{r}\ntitanic %>%\n  tabyl(passenger.class, survived) %>%\n  adorn_percentages() %>%\n  adorn_pct_formatting() %>%\n  adorn_ns() # To show original counts\n```\n\n```{r, fig.cap = \"Barplot of passenger survival by gender.\", fig.align = \"center\", out.width = \"50%\"}\nggplot(data = titanic, aes(x = survived, group = passenger.class)) +\n  geom_bar(aes(y = ..prop.., fill = passenger.class),\n            stat = \"count\", position = \"dodge\") +\n  labs(x = \"Survived the Titanic?\", y = \"Proportion\")\n```\n\nThe largest group of passengers who died were third class passengers, while among those who survived the largest group was first class passengers.\n\n```{r}\nmod.titanic <- logistic_reg()\nmod.titanic <- mod.titanic |> fit (survived ~ gender + passenger.class + age, data = titanic) |>\n  extract_fit_engine()\nmod.titanic %>%\n  summary()\n```\n\nWe see that the coefficient for males (`gendermale`) is negative, indicating a lower chance of survival for male passengers. Similarly, the coefficients for second (`passenger.class2`) and third (`passenger.class3`) class passengers are negative, with the magnitude of the third class coefficient larger than that of the second class coefficient. This suggests that second class passengers chances of survival were worse in comparison with first class passengers, and that third class passengers chances of survival were even worse. Finally the `age` coefficient is negative, suggesting that older people were less likely to survive.\n\n```{r, fig.cap = \"Odds of surviving the sinking of the Titanic.\", fig.align=\"center\", out.width = \"55%\"}\nplot_model(mod.titanic, show.values = TRUE,\n           title = \"\", show.p = FALSE, value.offset = 0.25)\n```\n\nWe interpret the odds ratios as follows: men's odds of survival were 0.07 times those of women, third class passengers' odds of survival were 0.10 times those of first class passengers, and second class passengers' odds of survival were 0.33 times those of first class passengers. Finally, for each year increase in the passenger's age, their odds of survival decrease (by a factor of 0.97).\n","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(moderndive)\nlibrary(ISLR)\nlibrary(skimr)\nlibrary(plotly)\nlibrary(tidyr)\nlibrary(datasets)\nlibrary(knitr)\nlibrary(janitor)\nlibrary(infer)\nlibrary(sjPlot)\nlibrary(stats)\nlibrary(readr)\nlibrary(janitor)\nlibrary(tidymodels)\n\nknitr::opts_chunk$set(echo = TRUE, comment = NA, out.width = '65%', fig.align = \"center\", fig.pos = 'H',\n                      warning = FALSE, message = FALSE)\n```\n\n```{=html}\n<style>\np.caption {\n  font-size: 1.4em;\n}\n</style>\n```\n# Further Tasks\n\n## Yanny or Laurel?\n\nThis auditory illusion first appeared on the internet in May 2018. An explanation of why people hear different things can be found in this [short video](https://www.youtube.com/watch?v=yDiXQl7grPQ), just one of many internet sources discussing the phenomenon. The main reason behind the difference appears to be that as we age we lose the ability to hear certain sounds. To see if we could find evidence of such an age effect, we asked students and staff at the School of Mathematics and Statistics at the University of Glasgow to fill out a survey on what they hear. Below you can see summaries of the responses.\n\n```{r, echo = FALSE}\nknitr::include_graphics(\"images/07_yl1.png\")\nknitr::include_graphics(\"images/07_yl2.png\")\nknitr::include_graphics(\"images/07_yl3.png\")\n```\n\nThe proportions hearing `Yanny` and `Laurel` are very similar to each other, and there are some respondents who hear both or even something completely different. This may be because people do not listen to the audio file using the same device, something we couldn't control for in the survey. Ignoring the responses other than `Yanny` or `Laurel`, we have 53 observations.\n\nDownload the data (`yanny.csv`) from Moodle and fit a logistic regression model with `hear` as the binary response variable, and `age` and `gender` as the explanatory variables. What are your findings?\n\n**Solution**\n\n```{r}\nyanny <- read_csv(\"yanny.csv\")\nyanny <- yanny %>%\n          select(hear, gender, age)\nyanny$hear <- as.factor(yanny$hear)\nyanny$gender <- as.factor(yanny$gender)\n```\n\n```{r, fig.cap = \"Hearing Yanny/Laurel by age.\", fig.align = \"center\"}\nggplot(data = yanny, aes(x = hear, y = age, fill = hear)) +\n  geom_boxplot() +\n  labs(x = \"What do you hear?\", y = \"Age\") +\n  theme(legend.position = \"none\")\n```\n\nWe see in the boxplot that the people who hear `Yanny` are, on average, younger, however there is some overlap in the IQR's.\n\n```{r}\nyanny %>%\n  tabyl(gender, hear) %>%\n  adorn_percentages() %>%\n  adorn_pct_formatting() %>%\n  adorn_ns() # To show original counts\n```\n\n```{r, fig.cap = \"Barplot of what participants heard by gender.\", fig.align = \"center\"}\nggplot(data = yanny, aes(x = hear, group = gender)) +\n  geom_bar(aes(y = ..prop.., fill = gender), stat = \"count\", position = \"dodge\") +\n  labs(x = \"What do you hear?\", y = \"Proportion\")\n```\n\nThere is a slightly smaller proportion of men hearing `Yanny`, but the proportions are very similar overall.\n\n```{r}\nmod.yanny <- logistic_reg()\nmod.yanny <- mod.yanny |> \n  fit(hear ~ age + gender, data = yanny) |>\n  extract_fit_engine()\n\nmod.yanny %>%\n  summary()\n```\n\n```{r}\nmod.yanny <- logistic_reg()\nmod.yanny <- mod.yanny |> fit(hear ~ age, data = yanny) |>\n  extract_fit_engine()\n\nmod.yanny %>%\n  summary()\n```\n\nNotice that the coefficient of `age` is negative, suggesting that older people are less likely to hear `Yanny`. However, the coefficient of `age` is not significant ($p$-value of 0.16). Still, if we wanted to use the estimated coefficient to quantify the effect of `age`, we would need to look at exp(-0.04812) = 0.953. This suggests that for two people who differ by one year in age, the older person's odds of hearing `Yanny` are 0.953 times those of the younger person. If we want to look at a ten-year age difference then the odds multiplier becomes exp(0.04812 \\* 10) = 1.618. Hence, for two people who differ by 10 years in age, the older person's odds of hearing `Yanny` are 1.618 times those of the younger person.\n\n```{r, fig.cap = \"Odds of hearing yanny with age.\", fig.align=\"center\", out.width =\"55%\"}\nplot_model(mod.yanny, show.values = TRUE,\n           title = \"Odds (Age)\", show.p = TRUE)\n```\n\n```{r, echo = TRUE, eval = TRUE, fig.cap = \"Probability of hearing Yanny with age.\", fig.align = \"center\", results = FALSE}\nplot_model(mod.yanny, type = \"pred\", terms = \"age\", title = \"\", axis.title = c(\"Age\", \"Probability of hearing Yanny\"))\n```\n\n## Titanic\n\nOn 15th April 1912, during its maiden voyage, the [Titanic](https://en.wikipedia.org/wiki/RMS_Titanic) sank after colliding with an iceberg, killing 1502 out of 2224 passengers and crew. One of the reasons that the shipwreck led to such loss of life was that there were not enough lifeboats for the passengers and crew. Although there was some element of luck involved in surviving the sinking, some groups of people were more likely to survive than others, such as women, children, and the upper-class.\n\nDownload the data (`titanic.csv`) from Moodle for $n = 891$ passengers aboard the Titanic and fit a logistic regression model with `survived` as the binary response variable, and `age`, `gender`, and `passenger.class` as the explanatory variables. What are your findings?\n\n**Solution**\n\n```{r}\ntitanic <- read_csv(\"titanic.csv\")\ntitanic <- titanic %>%\n          select(survived, age, gender, passenger.class)\ntitanic$survived <- as.factor(titanic$survived)\nlevels(titanic$survived) <- c(\"Died\", \"Survived\")\ntitanic$gender <- as.factor(titanic$gender)\ntitanic$passenger.class <- as.factor(titanic$passenger.class)\n```\n\n```{r, fig.cap = \"Titanic passenger age by survival.\", fig.align = \"center\", out.width = \"50%\"}\nggplot(data = titanic, aes(x = survived, y = age, fill = survived)) +\n  geom_boxplot() +\n  labs(x = \"Survived the Titanic?\", y = \"Age\") +\n  theme(legend.position = \"none\")\n```\n\nWe see in the boxplot that there is very little difference in the age of passengers who died or survived the sinking of the Titanic.\n\n```{r}\ntitanic %>%\n  tabyl(gender, survived) %>%\n  adorn_percentages() %>%\n  adorn_pct_formatting() %>%\n  adorn_ns() # To show original counts\n```\n\n```{r, fig.cap = \"Barplot of passenger survival by gender.\", fig.align = \"center\", out.width = \"50%\"}\nggplot(data = titanic, aes(x = survived, group = gender)) +\n  geom_bar(aes(y = ..prop.., fill = gender), stat = \"count\", position = \"dodge\") +\n  labs(x = \"Survived the Titanic?\", y = \"Proportion\")\n```\n\nThere is a clear pattern here with the proportion surviving much higher for females than for males.\n\n```{r}\ntitanic %>%\n  tabyl(passenger.class, survived) %>%\n  adorn_percentages() %>%\n  adorn_pct_formatting() %>%\n  adorn_ns() # To show original counts\n```\n\n```{r, fig.cap = \"Barplot of passenger survival by gender.\", fig.align = \"center\", out.width = \"50%\"}\nggplot(data = titanic, aes(x = survived, group = passenger.class)) +\n  geom_bar(aes(y = ..prop.., fill = passenger.class),\n            stat = \"count\", position = \"dodge\") +\n  labs(x = \"Survived the Titanic?\", y = \"Proportion\")\n```\n\nThe largest group of passengers who died were third class passengers, while among those who survived the largest group was first class passengers.\n\n```{r}\nmod.titanic <- logistic_reg()\nmod.titanic <- mod.titanic |> fit (survived ~ gender + passenger.class + age, data = titanic) |>\n  extract_fit_engine()\nmod.titanic %>%\n  summary()\n```\n\nWe see that the coefficient for males (`gendermale`) is negative, indicating a lower chance of survival for male passengers. Similarly, the coefficients for second (`passenger.class2`) and third (`passenger.class3`) class passengers are negative, with the magnitude of the third class coefficient larger than that of the second class coefficient. This suggests that second class passengers chances of survival were worse in comparison with first class passengers, and that third class passengers chances of survival were even worse. Finally the `age` coefficient is negative, suggesting that older people were less likely to survive.\n\n```{r, fig.cap = \"Odds of surviving the sinking of the Titanic.\", fig.align=\"center\", out.width = \"55%\"}\nplot_model(mod.titanic, show.values = TRUE,\n           title = \"\", show.p = FALSE, value.offset = 0.25)\n```\n\nWe interpret the odds ratios as follows: men's odds of survival were 0.07 times those of women, third class passengers' odds of survival were 0.10 times those of first class passengers, and second class passengers' odds of survival were 0.33 times those of first class passengers. Finally, for each year increase in the passenger's age, their odds of survival decrease (by a factor of 0.97).\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":{"pdf_document":{"fig_caption":"yes","latex_engine":"xelatex","number_sections":"no"},"html_document":{"df_print":"paged"}},"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css","include/webex.css"],"toc":true,"include-after-body":["include/webex.js"],"output-file":"DA_Week9_FurtherTasksSolutions.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","editor":"visual","theme":"cosmo","title":"| Data Analysis\n| Week 9 Further Tasks Solutions\n","header-includes":["\\usepackage{float}"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}